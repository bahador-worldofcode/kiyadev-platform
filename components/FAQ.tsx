"use client";

import { useState } from "react";
import { motion, AnimatePresence } from "framer-motion";
import { ChevronDown, MessageCircleQuestion } from "lucide-react";

// دسته‌بندی‌ها برای فیلتر کردن
const categories = ["همه", "وب و سایت", "اپلیکیشن", "هوش مصنوعی و بات", "بلاکچین و ارز دیجیتال", "فنی و دیباگ"];

const faqs = [
  // --- دسته: وب و سایت ---
  // +++ سوال جدید و استراتژیک برای سئو گوگل (Rich Snippet) +++
  { 
    category: "وب و سایت", 
    question: "هزینه طراحی سایت و اپلیکیشن در سال ۲۰۲۵ چقدر است؟", 
    answer: "در کیا دِو (KiyaDev) شروع قیمت طراحی سایت لندینگ پیج از ۱,۰۰۰,۰۰۰ تومان و سایت‌های شرکتی/فروشگاهی از ۵,۰۰۰,۰۰۰ تومان است. برای اپلیکیشن‌های اختصاصی و PWA، قیمت بر اساس فیچرها محاسبه می‌شود اما تلاش ما ارائه نرخ‌های دانشجویی و رقابتی است." 
  },
  { category: "وب و سایت", question: "تفاوت سایت اختصاصی با وردپرس در چیست؟", answer: "سایت‌های اختصاصی (Next.js) سرعت لود زیر ۱ ثانیه دارند، امنیتشان به دلیل دسترسی نداشتن به پلاگین‌های مخرب بسیار بالاتر است و محدودیت طراحی ندارند، در حالی که وردپرس کند و تکراری است." },
  { category: "وب و سایت", question: "آیا سایت‌های KiyaDev سئو شده هستند؟", answer: "بله، ما از معماری SSR استفاده می‌کنیم که باعث می‌شود گوگل در همان لحظه اول تمام محتوای شما را ایندکس کند. این بالاترین استاندارد سئو در سال ۲۰۲۵ است." },
  { category: "وب و سایت", question: "هزینه تمدید سالانه سایت چقدر است؟", answer: "فقط هزینه هاست و دامنه که به قیمت روز شرکت‌های میزبانی است. ما هیچ هزینه اضافی بابت 'اجاره سایت' از شما نمی‌گیریم." },
  { category: "وب و سایت", question: "آیا هاست و دامنه هم تهیه می‌کنید؟", answer: "بله، در پکیج‌های ما ثبت دامنه .ir و هاست پرسرعت آلمان/ایران به صورت رایگان برای سال اول انجام می‌شود." },
  { category: "وب و سایت", question: "سایت فروشگاهی قابلیت اتصال به انبارداری دارد؟", answer: "بله، ما می‌توانیم سایت را به نرم‌افزارهای حسابداری یا اکسل متصل کنیم تا موجودی کالاها خودکار بروز شود." },
  { category: "وب و سایت", question: "آیا می‌توانم سایت را چندزبانه کنم؟", answer: "بله، سیستم‌های ما از i18n پشتیبانی می‌کنند و شما می‌توانید سایت را برای بازارهای جهانی (انگلیسی، عربی و...) آماده کنید." },
  { category: "وب و سایت", question: "گواهی SSL یا همان قفل سبز را دارید؟", answer: "بله، تمام سایت‌های ما با گواهی امنیتی SSL رایگان و دائمی تحویل داده می‌شوند." },
  { category: "وب و سایت", question: "آیا امکان تغییر چیدمان سایت بعد از تحویل وجود دارد؟", answer: "بله، به دلیل کدنویسی کامپوننت‌محور، هر زمان بخواهید می‌توانید بخش‌های جدید اضافه یا بخش‌های قدیمی را تغییر دهید." },
  { category: "وب و سایت", question: "نماد اعتماد (اینماد) می‌گیرید؟", answer: "ما مشاوره و راهنمایی کامل برای دریافت اینماد و درگاه پرداخت را به شما ارائه می‌دهیم تا روند اداری آن سریع طی شود." },
  { category: "وب و سایت", question: "سایت لندینگ پیج با سایت شرکتی چه فرقی دارد؟", answer: "لندینگ پیج تک‌صفحه‌ای و متمرکز روی فروش یک محصول است، اما سایت شرکتی دارای صفحات متعدد مثل درباره ما، خدمات و وبلاگ است." },

  // --- دسته: اپلیکیشن ---
  { category: "اپلیکیشن", question: "تفاوت PWA با اپلیکیشن نیتیو چیست؟", answer: "PWA از طریق مرورگر نصب می‌شود و حجم بسیار کمی دارد و روی iOS هم بدون مشکل نصب می‌شود، اما اپلیکیشن نیتیو (APK) قدرت پردازشی بیشتری دارد." },
  { category: "اپلیکیشن", question: "آیا اپلیکیشن‌ها در کافه بازار و مایکت منتشر می‌شوند؟", answer: "بله، ما خروجی استاندارد جهت انتشار در گوگل‌پلی، بازار و مایکت را به شما تحویل می‌دهیم." },
  { category: "اپلیکیشن", question: "هزینه ساخت اپلیکیشن چطور محاسبه می‌شود؟", answer: "بستگی به امکانات (آنلاین بودن، چت، درگاه و...) دارد. شروع قیمت‌ها از مبالغ بسیار رقابتی دانشجویی است." },
  { category: "اپلیکیشن", question: "اپلیکیشن فلاتر (Flutter) بهتر است یا ری‌اکت نیتوی؟", answer: "ما هر دو را انجام می‌دهیم، اما فلاتر برای اپلیکیشن‌های با گرافیک بالا و سرعت اجرای یکنواخت در اندروید و آیفون عالی است." },
  { category: "اپلیکیشن", question: "آیا اپلیکیشن بدون اینترنت هم کار می‌کند؟", answer: "بله، می‌توانیم بخش‌هایی از اپلیکیشن را به صورت Offline-First طراحی کنیم تا داده‌ها را ذخیره کند." },
  { category: "اپلیکیشن", question: "آیا پنل مدیریت اپلیکیشن با سایت یکی است؟", answer: "بله، شما یک پنل واحد دارید که با تغییر در آن، هم سایت و هم اپلیکیشن شما همزمان بروزرسانی می‌شوند." },
  { category: "اپلیکیشن", question: "امنیت داده‌های کاربران در اپ چطور تامین می‌شود؟", answer: "با استفاده از توکن‌های JWT و رمزنگاری دوطرفه End-to-End، امنیت اطلاعات خصوصی کاربران را تضمین می‌کنیم." },
  { category: "اپلیکیشن", question: "آیا اپلیکیشن قابلیت ارسال پوش نوتیفیکیشن دارد؟", answer: "بله، شما می‌توانید برای کاربران خود پیام‌های تبلیغاتی یا اطلاع‌رسانی به صورت نوتیفیکیشن ارسال کنید." },

  // --- دسته: هوش مصنوعی و بات ---
  { category: "هوش مصنوعی و بات", question: "ربات تلگرام چه کارهایی می‌تواند انجام دهد؟", answer: "تقریباً همه چیز! از فروشگاه خودکار و دریافت فیش واریزی تا مدیریت گروه‌ها و اتصال به هوش مصنوعی برای پاسخگویی." },
  { category: "هوش مصنوعی و بات", question: "آیا می‌توانم چت‌جی‌پی‌تی (ChatGPT) را به سایت متصل کنم؟", answer: "بله، ما از طریق API اختصاصی، هوش مصنوعی را به دیتابیس شما متصل می‌کنیم تا به سوالات مشتریان درباره محصولاتتان پاسخ دهد." },
  { category: "هوش مصنوعی و بات", question: "هزینه شارژ ماهانه ربات تلگرام چقدر است؟", answer: "ربات‌های ما روی سرورهای ابری قرار می‌گیرند که هزینه بسیار ناچیز سالانه دارند و نیاز به شارژ ماهانه ندارند." },
  { category: "هوش مصنوعی و بات", question: "آیا ربات‌ها قابلیت دیلیت اکانت یا بلاک کردن دارند؟", answer: "بله، ربات‌های مدیریت گروه ما قابلیت فیلتر کلمات رکیک، حذف لینک و مدیریت کامل اعضا را دارند." },
  { category: "هوش مصنوعی و بات", question: "هوش مصنوعی چطور به فروش من کمک می‌کند؟", answer: "با تحلیل رفتار مشتری، هوش مصنوعی می‌تواند به آن‌ها پیشنهاد خرید هوشمندانه بدهد (مشابه سیستم پیشنهادات آمازون)." },

  // --- دسته: بلاکچین و ارز دیجیتال ---
  { category: "بلاکچین و ارز دیجیتال", question: "آیا صرافی ارز دیجیتال مشابه نوبیتکس می‌سازید؟", answer: "بله، پلتفرم‌های معاملاتی با نمودار لحظه‌ای، کیف پول اختصاصی و اتصال به گره‌های شبکه (Nodes) تخصص ماست." },
  { category: "بلاکچین و ارز دیجیتال", question: "ساخت توکن اختصاصی چقدر زمان می‌برد؟", answer: "طراحی توکن و قرارداد هوشمند (Smart Contract) روی شبکه‌های اتریوم یا ترون معمولاً بین ۲ تا ۴ روز زمان می‌برد." },
  { category: "بلاکچین و ارز دیجیتال", question: "آیا قراردادهای هوشمند شما امنیت دارند؟", answer: "بله، تمام قراردادها قبل از استقرار (Deploy) تست‌های امنیتی و ضد هک را پشت سر می‌گذارند." },
  { category: "بلاکچین و ارز دیجیتال", question: "پروژه NFT چیست و آیا انجام می‌دهید؟", answer: "بله، از طراحی گرافیکی کاراکترها تا قرارداد هوشمند و سایت مینت (Mint) پروژه را به صورت کامل انجام می‌دهیم." },
  { category: "بلاکچین و ارز دیجیتال", question: "Web3 چه تفاوتی با سایت‌های معمولی دارد؟", answer: "در Web3 کاربر با کیف پول (مثل Metamask) وارد می‌شود و مالکیت داده‌ها در دست خودش است، نه دیتابیس مرکزی." },

  // --- دسته: فنی و دیباگ ---
  { category: "فنی و دیباگ", question: "سایت من باگ دارد، آیا رفع می‌کنید؟", answer: "بله، ما خدمات دیباگ حرفه‌ای برای زبان‌های پایتون، جاوا اسکریپت و PHP داریم و هر خطایی را ریشه‌یابی می‌کنیم." },
  { category: "فنی و دیباگ", question: "آیا پروژه‌های نیمه‌تمام را قبول می‌کنید؟", answer: "بله، کدهای قبلی را بررسی می‌کنیم و اگر استاندارد باشند ادامه می‌دهیم، در غیر این صورت پیشنهاد بازنویسی می‌دهیم." },
  { category: "فنی و دیباگ", question: "چرا سایت من کند است؟", answer: "کندی می‌تواند از کدهای غیربهینه، تصاویر سنگین یا هاست ضعیف باشد. ما یک گزارش آنالیز رایگان به شما می‌دهیم." },
  { category: "فنی و دیباگ", question: "آیا امنیت سایت‌های هک شده را برمی‌گردانید؟", answer: "بله، پاکسازی کدهای مخرب و بستن حفره‌های امنیتی یکی از کارهای تخصصی تیم ماست." },
  { category: "فنی و دیباگ", question: "زبان پایتون برای چه پروژه‌هایی بهتر است؟", answer: "برای پردازش داده، هوش مصنوعی، ربات‌های هوشمند و بک‌اندهای بسیار سنگین و علمی." },
  { category: "فنی و دیباگ", question: "تفاوت دیتابیس SQL و NoSQL چیست؟", answer: "SQL برای داده‌های ساختاریافته (مثل مالی) و NoSQL برای داده‌های منعطف و حجیم (مثل شبکه‌های اجتماعی) استفاده می‌شود." },
  { category: "فنی و دیباگ", question: "آیا آموزش هم می‌دهید؟", answer: "بله، برای تمام پروژه‌ها یک ویدیوی آموزشی کامل از نحوه کار با پنل و مدیریت سیستم به شما تحویل داده می‌شود." },
  { category: "فنی و دیباگ", question: "پشتیبانی VIP شامل چه چیزهایی است؟", answer: "نظارت ۲۴ ساعته بر سلامت سرور، بک‌آپ‌گیری روزانه و اولویت در انجام تغییرات جدید." },
  { category: "فنی و دیباگ", question: "آیا برای شرکت‌های بزرگ رزومه دارید؟", answer: "ما به عنوان یک تیم دانشجویی نخبه، پروژه‌های موفقی در حوزه‌های مختلف استارتاپی و صنعتی داشته‌ایم." },
  { category: "فنی و دیباگ", question: "قرارداد کتبی هم می‌بندید؟", answer: "بله، تمام جزئیات پروژه، زمان تحویل و تعهدات ما در قالب قرارداد رسمی مکتوب می‌شود." },
  { category: "فنی و دیباگ", question: "آیا امکان مشاوره حضوری وجود دارد؟", answer: "فعلاً تمام مشاوره‌های ما به صورت آنلاین (ویدیویی یا متنی) است تا سرعت کار بالاتر برود." },
  { category: "فنی و دیباگ", question: "چطور به یک تیم دانشجویی اعتماد کنم؟", answer: "اعتماد شما بر اساس کیفیت کد و نمونه‌کارهای ماست. ما از جدیدترین علم دنیا استفاده می‌کنیم که شرکت‌های قدیمی هنوز به آن نرسیده‌اند." },
  { category: "فنی و دیباگ", question: "آیا کدهای پروژه را به من می‌دهید؟", answer: "بله، مالکیت ۱۰۰ درصد کدهای نوشته شده متعلق به شماست و در انتهای پروژه فایل‌ها تحویل می‌گردد." },
  { category: "فنی و دیباگ", question: "اگر از نتیجه راضی نباشم چه می‌شود؟", answer: "ما پروژه را در چندین مرحله تاییدیه می‌گیریم تا مطمئن شویم دقیقاً مطابق سلیقه و نیاز شما پیش می‌رود." },
  { category: "فنی و دیباگ", question: "بهترین زبان برای شروع یک استارتاپ چیست؟", answer: "ما ترکیب Next.js و Python را پیشنهاد می‌دهیم؛ چون هم سرعت فوق‌العاده‌ای دارد و هم قابلیت توسعه نامحدود." },
  { category: "فنی و دیباگ", question: "آیا سایت من در گوشی درست دیده می‌شود؟", answer: "صد در صد. تمام پروژه‌های ما Mobile-First طراحی می‌شوند و در تمام سایزهای نمایشگر عالی هستند." },
  { category: "فنی و دیباگ", question: "چقدر طول می‌کشد تا در گوگل رتبه بگیرم؟", answer: "با سئوی تکنیکال ما، سایت شما سریع ایندکس می‌شود، اما رتبه گرفتن در کلمات سخت معمولاً ۳ تا ۶ ماه زمان می‌برد." },
  { category: "فنی و دیباگ", question: "آیا پروژه رایگان هم انجام می‌دهید؟", answer: "خیر، اما برای پروژه‌های خیریه یا عام‌المنفعه تخفیف‌های بسیار ویژه‌ای در نظر می‌گیریم." },
  { category: "فنی و دیباگ", question: "محدودیت تعداد محصولات در سایت فروشگاهی چقدر است؟", answer: "در سیستم‌های کدنویسی ما هیچ محدودیتی وجود ندارد؛ شما می‌توانید ۱۰۰ محصول یا ۱ میلیون محصول داشته باشید." },
  { category: "فنی و دیباگ", question: "تفاوت هاست ایران و خارج چیست؟", answer: "هاست ایران برای کاربران داخل کشور سریع‌تر باز می‌شود و هاست خارج برای سئو و ارتباط با سرویس‌های جهانی بهتر است." },
  { category: "فنی و دیباگ", question: "آیا پنل مدیریت روی گوشی هم کار می‌کند؟", answer: "بله، پنل مدیریتی که ما می‌سازیم کاملاً ریسپانسیو است و با گوشی هم می‌توانید سایت را مدیریت کنید." },
  { category: "فنی و دیباگ", question: "چرا KiyaDev را انتخاب کنیم؟", answer: "ترکیب دانش روز، قیمت منصفانه، سرعت اجرای بالا و تعهد قلبی ما به رشد کسب‌وکار شما." }
];

export default function FAQ() {
  const [activeCategory, setActiveCategory] = useState("همه");
  const [openIndex, setOpenIndex] = useState<number | null>(null);
  const [visibleCount, setVisibleCount] = useState(8); // تعداد سوالاتی که در ابتدا نمایش داده می‌شود

  const filteredFaqs = faqs.filter(
    (faq) => activeCategory === "همه" || faq.category === activeCategory
  );

  return (
    <section className="bg-black py-24 px-6 border-t border-white/5 relative overflow-hidden">
      
      {/* بک‌گراند نوری محو */}
      <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full h-full bg-blue-500/5 blur-[120px] rounded-full pointer-events-none" />

      <div className="container mx-auto max-w-4xl relative z-10">
        
        {/* هدر بخش */}
        <div className="text-center mb-16">
          <motion.div 
            initial={{ scale: 0.8, opacity: 0 }}
            whileInView={{ scale: 1, opacity: 1 }}
            className="inline-flex items-center justify-center p-3 rounded-2xl bg-blue-500/10 text-blue-500 mb-4"
          >
            <MessageCircleQuestion size={32} />
          </motion.div>
          <h2 className="text-3xl font-bold text-white md:text-5xl mb-4">مرکز پاسخ‌گویی هوشمند</h2>
          <p className="text-gray-400">هر سوالی که در ذهن دارید، ما قبلاً به آن پاسخ داده‌ایم.</p>
        </div>

        {/* فیلتر دسته‌بندی */}
        <div className="flex flex-wrap justify-center gap-2 mb-12">
          {categories.map((cat) => (
            <button
              key={cat}
              onClick={() => {
                setActiveCategory(cat);
                setVisibleCount(8);
                setOpenIndex(null);
              }}
              className={`px-5 py-2 rounded-full text-sm font-medium transition-all ${
                activeCategory === cat 
                ? "bg-blue-600 text-white shadow-lg shadow-blue-600/20" 
                : "bg-white/5 text-gray-400 hover:bg-white/10"
              }`}
            >
              {cat}
            </button>
          ))}
        </div>

        {/* لیست آکاردئونی */}
        <div className="space-y-3">
          <AnimatePresence mode="popLayout">
            {filteredFaqs.slice(0, visibleCount).map((faq, index) => (
              <motion.div
                key={faq.question}
                layout
                initial={{ opacity: 0, y: 10 }}
                animate={{ opacity: 1, y: 0 }}
                exit={{ opacity: 0, scale: 0.95 }}
                className={`rounded-2xl border transition-all duration-300 ${
                  openIndex === index 
                  ? "border-blue-500/50 bg-blue-500/5" 
                  : "border-white/10 bg-white/5 hover:border-white/20"
                }`}
              >
                <button
                  onClick={() => setOpenIndex(openIndex === index ? null : index)}
                  className="flex w-full items-center justify-between p-5 text-right"
                >
                  <span className={`font-bold transition-colors ${openIndex === index ? "text-blue-400" : "text-gray-200"}`}>
                    {faq.question}
                  </span>
                  <div className={`p-1 rounded-lg transition-all ${openIndex === index ? "bg-blue-500 text-white rotate-180" : "bg-white/5 text-gray-500"}`}>
                    <ChevronDown size={18} />
                  </div>
                </button>
                
                <AnimatePresence>
                  {openIndex === index && (
                    <motion.div
                      initial={{ height: 0, opacity: 0 }}
                      animate={{ height: "auto", opacity: 1 }}
                      exit={{ height: 0, opacity: 0 }}
                      className="overflow-hidden"
                    >
                      <div className="px-5 pb-5 text-sm leading-relaxed text-gray-400 border-t border-white/5 pt-4">
                        {faq.answer}
                      </div>
                    </motion.div>
                  )}
                </AnimatePresence>
              </motion.div>
            ))}
          </AnimatePresence>
        </div>

        {/* دکمه نمایش بیشتر */}
        {visibleCount < filteredFaqs.length && (
          <div className="mt-12 text-center">
            <button
              onClick={() => setVisibleCount(prev => prev + 8)}
              className="px-8 py-3 rounded-xl border border-white/10 bg-white/5 text-white font-bold hover:bg-white/10 transition-all active:scale-95"
            >
              مشاهده سوالات بیشتر ...
            </button>
          </div>
        )}

      </div>
    </section>
  );
}